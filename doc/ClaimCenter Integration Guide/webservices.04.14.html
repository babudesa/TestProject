<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Web Services Using ClaimCenter Clusters</title>
    <link rel="StyleSheet" href="css/webservices.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="webservices.04.01.html#3543396">Web Services (SOAP)</a> : Web Services Using ClaimCenter Clusters</span></div>
    <hr align="left" />
    <blockquote>
      <div class="H1_-_Heading_1"><a name="3543396">Web Services Using ClaimCenter Clusters</a></div>
      <div class="B_-_Body"><a name="3543400">If you write integration code that connects to a ClaimCenter cluster, be aware of important considerations about </a>choosing which server to connect.</div>
      <div class="H2_-_Heading_2"><a name="3543165">Optimizing for Load Balancing</a></div>
      <div class="B_-_Body"><a name="3541640">The SOAP protocol does not natively support session affinity, so some load-balancers are not able to reliably </a>direct all calls to the same server every time. There are two similar but different concepts that relate to load balancing:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3541641">Conversational versus non-conversational mode.</a></span> This is primarily an issue of reducing re-authentication to a server. This would allow you to load balance with good performance without requiring session (cookie) support. For more information, see <a href="javascript:WWHClickedPopup('integration', 'webservices.04.14.html#3541689', '');" title="Web Services Using ClaimCenter Clusters">“Conversational and Non-Conversational SOAP Modes”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3543051">Cookie support for certain types of load-balancing routers.</a></span> To ensure that a load balancing router that supports cookie tracking, ClaimCenter supports session affinity using cookies. For more information, see <a href="javascript:WWHClickedPopup('integration', 'webservices.04.14.html#3543290', '');" title="Web Services Using ClaimCenter Clusters">“Statefullness of Connection Using Cookies”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H3_-_Heading_3"><a name="3541689">Conversational and Non-Conversational SOAP Modes</a></div>
      <div class="B_-_Body"><a name="3541693">The SOAP protocol defines several approaches to server-client communication. ClaimCenter supports SOAP </a><span class="e_-_emphasis">conversational mode</span> and <span class="e_-_emphasis">non-conversational mode</span>. If you use <span class="e_-_emphasis">conversational mode</span> with SOAP APIs, you connect directly to a <span class="e_-_emphasis">specific</span> server rather than letting a load-balancer direct the call to any server in the cluster. </div>
      <div class="B_-_Body"><a name="3543418">Improperly load-balanced API calls in conversational mode might authenticate to one server but following </a>requests go to another server in the cluster. If this happens, the original session ID is invalid.</div>
      <div class="B_-_Body"><a name="3543324">There are several approaches to avoid this issue with conversational mode:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3543325">Direct all calls directly to a specific server by name (</a><span class="cv_-_computer_voice">myserver1</span>, <span class="cv_-_computer_voice">myserver2</span>) or by IP number.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3543326">Use a modern load balancer that supports </a><span class="e_-_emphasis">IP stickiness</span>. IP stickiness means you can configured it to consistently direct all requests from one incoming IP address to one specific server.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3543327">Stop using conversational mode and instead switch to non-conversational mode for SOAP API access. </a>Perhaps switch only for certain types of communications. Remember to reconfigure your load balancer accordingly.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3543253">It is common to implement a user authentication plugin that controls user authentication using an external service </a>such as LDAP or other single-sign on systems. In non-conversational mode, ClaimCenter calls the user authentication plugin to authenticate with <span class="s_-_strong">every SOAP request</span> . ClaimCenter has little control over the performance and resources required by that code, so performance can be affected. To learn about the authentication plugin, see <a href="javascript:WWHClickedPopup('integration', 'authentication.12.1.html#1463262', '');" title="Authentication Integration">“Authentication Integration”</a>. </div>
      <div class="B_-_Body"><a name="3543263">In theory, conversational mode can improve performance, particularly for large numbers of small API requests. </a></div>
      <div class="B_-_Body"><a name="3543377">In real-world implementations, customers typically choose to write authentication plugins that cache their results </a>from their authentication provider for at least a few minutes. Because of this, the performance advantage of SOAP conversational mode is low for some customers. Guidewire encourages real-world testing to deterine the ideal configuration for your authentication plugin design (especially caching) and the frequency of API calls. On a related note, it is typically better to design customer SOAP APIs for appropriately-targeted data updates. (For example, one API method for each logical transaction, <span class="s_-_strong">not</span> one API method for every property change.)</div>
      <div class="B_-_Body"><a name="3541422">If you use the </a><span class="cv_-_computer_voice">APILocator</span> method <span class="cv_-_computer_voice">getAuthenticatedProxy</span> as documented, your API client uses conversational mode. If you use ClaimCenter clusters, you must configure your load balancers to ensure session affinity. Session affinity means that each request from a client must go to the same server. </div>
      <div class="B_-_Body"><a name="3541426">To use non-conversational mode, use </a><span class="cv_-_computer_voice">APILocator.getUnauthenticatedProxy(...)</span> instead of <span class="cv_-_computer_voice">APILocator.getAuthenticatedProxy(...)</span>. Although this is not generally recommended, this allows you to use ClaimCenter clusters without requiring session affinity. Each time the client code connects over SOAP, it authenticates with the server for that API call only. Additional API calls reauthenticate with the server.</div>
      <div class="B_-_Body"><a name="3541430">To learn more about conversational mode of SOAP interactions, refer to the World Wide Web Consortium site:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="3543288">http://www.w3.org/TR/xmlp-scenarios</a></div>
      <div class="H3_-_Heading_3"><a name="3543290">Statefullness of Connection Using Cookies</a></div>
      <div class="B_-_Body"><a name="3543291">By default, the Guidewire web services implementation does not ask the application server to generate and return </a>session cookies. However, ClaimCenter supports cookie-based load-balancing options for web services. The web services layer can hold session state by generating a cookie. This helps load balance consecutive SOAP calls done in the same conversation. This feature simplifies things like portal integration. If your load balancing router supports this feature, further requests by the same user (assuming they reused the same cookie) are redirected to <span class="s_-_strong">the same node in the cluster</span>.</div>
      <div class="B_-_Body"><a name="3541438">You can enable stateful conversational SOAP call load-balancing in several ways:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3541439">For simple HTTP requests or from Gosu web service APIs, append the text </a><span class="cv_-_computer_voice">"?stateful"</span> (with no quotes) to the URL. You can use this approach for ClaimCenter to ContactCenter integration to load balance the connection to ContactCenter.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3543045">From web service client code programatically through Axis, add the following method given a reference to </a>the Guidewire web service interface:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="3543046">((org.apache.axis.client.Service) webServiceReference ).setMaintainSession( true ); </a></div>
      <div class="H2_-_Heading_2"><a name="3543100">Built-in Web Services With Special Cluster Behaviors</a></div>
      <div class="B_-_Body"><a name="3543118">There is only one batch server in any cluster. Some API requests only work with the batch server because they </a>make use of services that only run on the batch server. The batch-server-only API requests include:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3543121">The messaging services such as </a><span class="cv_-_computer_voice">IMessagingToolsAPI</span> run only on the batch server. In other words, all <span class="cv_-_computer_voice">IMessagingToolsAPI</span> interface methods require that you make the SOAP request only to the batch server.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3543123">Background process actions run only on the batch server. You must call batch process APIs only to the batch </a>server. These APIs start background processes, check on background processes, or terminate background processes. For more about background processes, see <a href="javascript:WWHClickedPopup('admin', 'batch.13.01.html#1030690', '');" title="Batch Processes and Work Queues">“Batch Processes and Work Queues” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('admin', 'batch.13.01.html#1030690', '');" title="Batch Processes and Work Queues">System Administration Guide</a></span>. You can start background processes using the built-in scheduler or using the SOAP API <span class="cv_-_computer_voice">IMaintenanceToolsAPI.startBatchProcess()</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="3583790">Background processes include activity escalation, claim exceptions, financials escalation (for sending sched</a>uled checks), and generating database statistics. </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3583791">Purging claims can only occur on the batch server. To do this, use the API call </a><span class="cv_-_computer_voice">IMaintenanceToolsAPI.startBatchProcess("purge")</span> with the batch server.</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3543137">Table import actions can occur only on the batch server. In other words, all </a><span class="cv_-_computer_voice">ITableImportAPI</span> interface methods require that you make the SOAP request directly to the batch server computer.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3543138">Some APIs only affect the server to which the call is made, in contrast to most APIs that add or modify entity </a>data. Typical APIs force stale copies of entity data in other ClaimCenter servers to purge from the server in-memory cache. You can send these API calls to any server and all server update with the new information. However, some APIs change run time attributes of the server itself and only change the server to which you send the request:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="3543143">ISystemToolsAPI.setRunlevel</a></span> </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="3543145">ISystemToolsAPI.updateLoggingLevel</a></span> </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="3543147">ISystemToolsAPI.getActiveSessionData</a></span> </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="3543149">ILoginAPI</a></span> – for setting up or releasing a session with a specific server</div>
            </td>
          </tr>
        </table>
      </div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>