<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Document Production</title>
    <link rel="StyleSheet" href="css/documentsforms.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="documentsforms.13.1.html#2121312">Document Management</a> : Document Production</span></div>
    <hr align="left" />
    <blockquote>
      <div class="H1_-_Heading_1"><a name="2121312">Document Production</a></div>
      <div class="B_-_Body"><a name="2121318">From the ClaimCenter user interface, create forms and letters and choose the desired template. You can select </a>other parameters (some optional) to pass to the document production engine. ClaimCenter supports Gosu-initiated automatic document creation from business rules. The automatic and manual processes are similar, but the automatic document creation skips the first few steps of the process. The automated creation process skips some steps relating to parameters that the user chooses in the user interface. Instead, the Gosu code that requests the new document sets these values.</div>
      <div class="B_-_Body"><a name="1881673">The following diagram illustrates the interactions between ClaimCenter, the various services, an editor, and an </a>external document management system to manage the generation of a form or letter. The Gosu-initiated automatic document creation would begin at the step labelled “Request document production”.</div>
      <div class="FFP_-_Figure_Full_Page"><a name="1881681"><img class="Default" src="images/documentsforms.13.3.1.png" style="display: inline; float: none; left: 0.0; top: 0.0" alt="" /></a></div>
      <div class="B_-_Body"><a name="1881682">The chronological steps are as follows:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="1881688">ClaimCenter invokes the </a><span class="e_-_emphasis">document creation user interface</span> to let the user select a form or letter template.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881692">The ClaimCenter document creation user interface requests a list of templates from the </a><span class="e_-_emphasis">template source</span>, which is a plugin that acts like a repository of templates.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881693">The </a><span class="e_-_emphasis">template source</span> returns a list of templates.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881694">The document creation user interface displays a list of templates and lets the user choose one, perhaps after </a>searching or filtering among the list of templates. Searching and filtering uses the template metadata, which is information about the templates themselves.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881695">After you select a template, the document creation user interface returns the chosen template’s </a><span class="e_-_emphasis">template</span><span class="e_-_emphasis">&nbsp;</span><span class="e_-_emphasis">descriptor</span> information to ClaimCenter.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2102572">ClaimCenter prompts the document creation user interface for other document production parameters for the </a>document merge. For example, choose the recipient of a letter or other required or optional properties for the template. After the user enters this data, the user interface returns the parameter data to ClaimCenter. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	7.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881713">ClaimCenter chooses the appropriate document production plugin from values in the template descriptor. The </a>descriptor file can indicate a specific document production plugin or let one be chosen based on the file’s MIME type. The document production plugin gets a template descriptor and the parameter data values.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	8.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881714">The document production plugin asks the template source for the actual template file.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	9.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1897723">The document production plugin takes whatever steps are necessary to launch an editor application or other </a>“engine” for merging the template file with the parameter data. ClaimCenter includes document production plugins that process Microsoft Word files, Adobe Acrobat (PDF) files, Microsoft Excel files, Gosu templates, and plain text files. For Gosu templates, the Gosu document production plugin executes the Gosu template using the parameter data. The result of this step is a <span class="e_-_emphasis">merged document</span>. It is possible to produce documents using applications on the user’s computer, a process known as client-side document production. For example, the built-in production plugins use client-side production for Microsoft Word documents, Microsoft Excel documents, and client-side PDF document production. The plugins return JScript code to the client which calls the local application to open the file and merge in necessary fields. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	10.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1897611">If the document was created from the user interface, ClaimCenter automatically downloads the file to the </a>user’s local machine if the configuration parameter <span class="cv_-_computer_voice">AllowActiveX</span> is enabled. The file opens in the appropriate application on the user desktop. The user can print the file, and if the editor application supports editing, users can optionally change it and resave it in the editor application. This describes the reference implementation, but the user interface flow can work differently if you customize the PCF files for a different workflow.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	11.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881728">If the file is on the user’s PC, the user uploads the completed local merged document (or lets the user choose </a>a different document to upload). The user can then specify some additional parameters about the document. If the configuration parameter <span class="cv_-_computer_voice">AllowActiveX</span> is enabled, the upload step by the Guidewire Active/X control <span class="cv_-_computer_voice">GuidewireDocumentAssistant</span> supplies the location of the local merged document. If that parameter is not enabled or the control is not installed, then the user must manually browse to the local location of the merged document to upload.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	12.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1881730">Additionally, depending on the type of document production, the production engine could add the document </a>to the document storage system. The production system or the storage system could notify ClaimCenter using plugin code or from an external system using the web services API. For more information about document storage, see <a href="javascript:WWHClickedPopup('integration', 'documentsforms.13.6.html#2120365', '');" title="Document Storage">“Document Storage”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="1885292">The steps earlier describe the reference implementation, but many parts can be customized.</a></div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="2145152">The user interface flow can work differently by customizing the user interface PCF </a>configuration files and in some cases customizing the document-related plugins.</div>
      <div class="H2_-_Heading_2"><a name="2145153">Document Production Plugins</a></div>
      <div class="B_-_Body"><a name="2145160">As mentioned in </a><a href="javascript:WWHClickedPopup('integration', 'documentsforms.13.3.html#2121312', '');" title="Document Production">“Document Production”</a>, ClaimCenter supports <span class="e_-_emphasis">synchronous production</span> (the document contents return immediately) and <span class="e_-_emphasis">asynchronous production</span> (the creation method returns immediately but creation happens later). These two types of document production have different integration requirements.</div>
      <div class="B_-_Body"><a name="1862746">For synchronous production, ClaimCenter and its installed </a><span class="e_-_emphasis">document storage</span> plugins are responsible for persisting the resulting document, including both the document metadata and document contents. In contrast, for asynchronous document creation, the <span class="e_-_emphasis">document production</span> (<span class="cv_-_computer_voice">IDocumentProduction</span>) plugins are responsible for persisting the data.</div>
      <div class="B_-_Body"><a name="1885414">The </a><span class="cv_-_computer_voice">IDocumentProduction</span> plugin is an interface to a document creation system for a certain type of document. The document creation process may involve extended workflow and/or asynchronous processes, and it may depend on <span class="cv_-_computer_voice">Document</span> entity or set properties in the <span class="cv_-_computer_voice">Document</span>.</div>
      <div class="B_-_Body"><a name="1885418">There are some additional related interfaces that assist the </a><span class="cv_-_computer_voice">IDocumentProduction</span> plugin:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="1885421">IDocumentTemplateSource</a></span> and <span class="cv_-_computer_voice">IDocumentTemplateDescriptor</span> encapsulate the basic interface for searching for and retrieving templates describing the document to be created. This includes the basic metadata (name, MIME type, and so on) and a pointer to the template content. Specifically, <span class="cv_-_computer_voice">IDocumentTemplateDescriptor</span> describes the templates used to create documents and <span class="cv_-_computer_voice">IDocumentTemplateSource</span> plugin actually lists and retrieves the document templates</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="1885436">IPDFMergeHandler</a></span> - Used in creation of PDF documents. View the built-in imlementation to set parameters in the default implementation. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="1845874">The </a><span class="cv_-_computer_voice">IDocumentProduction</span> plugin has two main methods: <span class="cv_-_computer_voice">createDocumentSynchronously</span> and <span class="cv_-_computer_voice">createDocumentAsynchronously.</span></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1845878">The </a><span class="cv_-_computer_voice">createDocumentSynchronously</span> method returns document contents as:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="2100211">raw document contents (an </a><span class="e_-_emphasis">input stream</span>)</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="2100215">a web page containing an ActiveX control </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="2100217">Jscript code to run on the user’s machine. The Jscript code response type is useful for client-side docu</a>ment product, such as the built-in production plugins for Microsoft Word documents, Microsoft Excel documents, and client-side PDF creation.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="2100219">a URL that can display the content (perhaps in an Active/X control) from a local content store.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="2145050">These settings are defined as the </a><span class="cv_-_computer_voice">ResponseType</span> property within <span class="cv_-_computer_voice">DocumentContentsInfo</span>, which is the return result from synchronous production methods. Possible response types include <span class="cv_-_computer_voice">DOCUMENT_CONTENTS</span>, <span class="cv_-_computer_voice">HTML_PAGE</span>, <span class="cv_-_computer_voice">JSCRIPT</span>, or <span class="cv_-_computer_voice">URL</span>.</div>
      <div class="LP_-_List_Para"><a name="2145051">For synchronously-created documents, the </a><span class="s_-_strong">caller</span> of the <span class="cv_-_computer_voice">createDocumentSynchronously</span> method must pass the contents to the <span class="e_-_emphasis">document content plugin</span> for persistence. The <span class="cv_-_computer_voice">Document</span> parameter can be modified if the <span class="cv_-_computer_voice">DocumentProduction</span> plugin wants to set any properties for persistence in the database. </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1845862">The </a><span class="cv_-_computer_voice">createDocumentAsynchronously</span> method returns the document status, such as a <span class="e_-_emphasis">status</span><span class="e_-_emphasis">&nbsp;</span><span class="e_-_emphasis">URL</span> that could display the status of the document creation. In the reference implementation, none of the built-in document production plugins support asynchronous document creation. The default user interface does not actually use the results of the <span class="cv_-_computer_voice">createDocumentAsynchronously</span> method. To support this type of status update, customize the user interface PCF files to generate a new user interface,. Also, customize the included <span class="cv_-_computer_voice">DocumentProduction</span> Gosu class that generates documents from Gosu. By default, <span class="cv_-_computer_voice">DocumentProduction</span> does not use the result of the <span class="cv_-_computer_voice">createDocumentAsynchronously</span> method.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2145078">For asynchronously-created documents, your </a><span class="cv_-_computer_voice">createDocumentAsynchronously</span> method must put the newly created contents into the DMS. Next, your external system can use SOAP APIs to add the document (see the <span class="cv_-_computer_voice">IClaimAPI</span> interface) to notify ClaimCenter that the document now exists. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="2145235">If your code to add the document is running within the server in local Gosu or Java code, do not call the </a>SOAP APIs to call back the same server. Calling back to the same server using SOAP is not generally safe. Instead, use domain methods on the entity to add the entity. For example:</div>
      <div class="CS_-_Code_Single_Line"><a name="2145264">newDocumentEntity = Claim.addDocument()</a></div>
      <div class="B_-_Body"><a name="1853401">In either case, immediately throw an exception if any part of your creation process fails.</a></div>
      <div class="B_-_Body"><a name="1897740">It is possible to produce documents using applications on the user’s computer, a process known as </a><span class="e_-_emphasis">client-side </span><span class="e_-_emphasis">document production</span>. For example, the built-in production plugins use client-side production for Microsoft Word documents, Microsoft Excel documents, and client-side PDF document production. The plugins display JScript code to the client which calls the local application to open the file and merge in necessary properties.</div>
      <div class="B_-_Body"><a name="1897741">Depending on whether the client machine has Acrobat Viewer or full Acrobat, the user may or may not be able to </a>save the resulting <span class="cv_-_computer_voice">.pdf</span> file. To save PDF changes, the full version of Adobe Acrobat is required, otherwise the user can just print the merged document.</div>
      <div class="B_-_Body"><a name="1897765">For more information about the built-in production plugins, see </a><a href="javascript:WWHClickedPopup('integration', 'documentsforms.13.4.html#1883694', '');" title="Document Template Descriptors">“Built-in Document Production Plugins”</a>.</div>
      <div class="B_-_Body"><a name="1885491">For more details on specific methods of these plugins, refer to the Java API Reference Javadoc. In the Javadoc, </a>there are two versions of the <span class="cv_-_computer_voice">IDocumentProduction</span> interface. There is a base class Guidewire platform version with “<span class="cv_-_computer_voice">.pl.</span>” in the fully-qualified package name. To implement the plugin, you must implement the other version, the ClaimCenter-specific version, which has “<span class="cv_-_computer_voice">.cc.</span>” in its fully-qualified package name.</div>
      <div class="H2_-_Heading_2"><a name="1846336">Configuring Document Production and MIME Types</a></div>
      <div class="B_-_Body"><a name="2083927">The document production configuration is defined in the Plugins editor in Studio for the definition of the </a><span class="cv_-_computer_voice">IDocumentProduction</span> plugin. In the plugin definition, it includes parameters (as elements) that define a <span class="e_-_emphasis">template type</span> and a <span class="cv_-_computer_voice">IDocumentProduction</span> plugin implementation that handles production for that type of template. In this context, a <span class="e_-_emphasis">template type</span> is either a MIME type or an custom (arbitrary) <span class="e_-_emphasis">template production type</span> text value that you provide.</div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="2083957">For information about, see </a><a href="javascript:WWHClickedPopup('config', 'studio_plugins.13.1.html#1178213', '');" title="Using the Plugins Editor">“Using the Plugins Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_plugins.13.1.html#1178213', '');" title="Using the Plugins Editor">Configuration Guide</a></span></div>
      <div class="B_-_Body"><a name="1885652">Create new template types by adding parameters to this list, then providing a new </a><span class="cv_-_computer_voice">IDocumentProduction</span> implementation. Finally, deploy the class files in <span class="cv_-_computer_voice">ClaimCenter/modules/configuration/plugins/document/</span><span class="cv_-_computer_voice">classes</span> and necessary libraries in <span class="cv_-_computer_voice">ClaimCenter/modules/configuration/plugins/document/lib</span>.</div>
      <div class="B_-_Body"><a name="2084333">A typical document production configuration includes references to the built-in </a><span class="cv_-_computer_voice">IDocumentProduction</span> implementations for common file types. For example, for parameter <span style="font-family: &quot;Lucida Sans Typewriter&quot;; font-size: 7.0pt">application/msword</span> it has the value <span class="cv_-_computer_voice">com.guidewire.cc.plugin.document.internal.WordDocumentProductionImpl</span>. Refer to Studio for the built-in settings for other production types.</div>
      <div class="B_-_Body"><a name="2084341">ClaimCenter determines which </a><span class="cv_-_computer_voice">IDocumentProduction</span> implementation to create a document with the following procedure:</div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="1885745">First ClaimCenter looks for an entry in this list that matches the template’s document production type stored </a>in its <span class="cv_-_computer_voice">documentProductionType</span> property.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1885750">If no match was found yet, ClaimCenter tries to find the template’s </a><span class="cv_-_computer_voice">mimeType</span> as a listed template type in this list. The example earlier lists MIME types not document production types.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1885729">If no match was found yet, document creation fails.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="1845954">If desired, you can also replace the default dispatching implementation with your own </a><span class="cv_-_computer_voice">IDocumentProduction</span> implementation.</div>
      <div class="B_-_Body"><a name="1846161">Note also that ClaimCenter supports both server-side PDF generation (which is the default) and client-side PDF </a>generation. The client-side implementation can be enabled by changing <span class="cv_-_computer_voice">ServerSidePDFDocumentProductionImpl</span> in the configuration under the parameter with the name set to <span style="font-family: &quot;Lucida Sans Typewriter&quot;; font-size: 7.0pt">"application/pdf" </span>to the client side built-in plugin value:</div>
      <div class="CS_-_Code_Single_Line"><a name="2084376">com.guidewire.cc.plugin.document.internal.ClientSidePDFDocumentProductionImpl</a></div>
      <div class="B_-_Body"><a name="1846141">Also, be aware that the </a><span class="cv_-_computer_voice">ServerSidePDFDocumentProductionImpl</span> uses the <span class="cv_-_computer_voice">IPDFMergeHandler</span> plugin interface. </div>
      <div class="B_-_Body"><a name="1882107">For more details on the built-in classes, see the </a><a href="javascript:WWHClickedPopup('integration', 'documentsforms.13.4.html#1883694', '');" title="Document Template Descriptors">“Built-in Document Production Plugins”</a>.</div>
      <div class="B_-_Body"><a name="1882111">Adding a custom MIME type such that it is recognized by ClaimCenter requires several steps:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="1885770">In Guidewire application’s </a><span class="cv_-_computer_voice">config.xml</span> file, add the new MIME type to the <span class="cv_-_computer_voice">&lt;mimetypemapping&gt;</span> section. The information in this section consists of four items:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="1885771">The name of the MIME type, which is the same as the identifying string, such as </a><span class="cv_-_computer_voice">"text/plain"</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="1885772">The file extensions to use for the MIME type. If more than one extension applies, separate extensions with </a>a pipe symbol (<span class="cv_-_computer_voice">"|"</span>). ClaimCenter uses this information to map both from the MIME type to the file extension, and from the file extension to the MIME type. To map from the MIME type to the file extension, ClaimCenter uses the first extension in the list. To map from extension to type, ClaimCenter uses the first <span class="cv_-_computer_voice">&lt;mimetype&gt;</span> entry containing that extension.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="1862898">The image file path for documents of this MIME type. At runtime, this image must be in the </a><span class="ps_-_parameter_in_code_snippets">SERVER</span><span class="cv_-_computer_voice">/</span><span class="cv_-_computer_voice">webapps/cc/resources/images</span> directory.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><a name="1897778">A human-readable description of the MIME type.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="1898359">Add the MIME type to the configuration of the application server, if required. This varies based on the details </a>of the web application server configuration. For Apache Tomcat, configure MIME type information in the Tomcat <span class="cv_-_computer_voice">web.xml</span> configuration file. Within that file’s <span class="cv_-_computer_voice">&lt;mime-mapping&gt;</span> tags, ensure that the MIME type you need already exists correctly in this list, or add it.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H3_-_Heading_3"><a name="2065713">Server-side PDF Licensing</a></div>
      <div class="B_-_Body"><a name="2065987">In the ClaimCenter reference implementation, the server-side PDF generation software is made by a company </a>called Big Faceless Org (BFO). Without a license, the generated documents contain a large watermark <span class="cv_-_computer_voice">"DEMO"</span> on the face of each generated page, rather than preventing document creation entirely. To remove the “demo” watermark, you must obtain a license key through Guidewire Customer Support. </div>
      <div class="B_-_Body"><a name="2068011">All server-side PDF generation licenses are licensed </a><span class="e_-_emphasis">per server CPU</span>, not per server.</div>
      <div class="B_-_Body"><a name="2068022">With your copy of ClaimCenter, you are entitled to </a><span class="s_-_strong">four CPU</span> licenses for PDF generation. However, you must still go through a process to obtain the keys associated with your licenses. In addition, you may purchase additional licenses through the same process. </div>
      <div class="B_-_Body"><a name="2065936">To obtain a license key:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="2065730">Contact your Customer Support Partner or email </a><span class="cv_-_computer_voice">support@guidewire.com</span> with your request for a PDF generation license for ClaimCenter.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2065731">A support engineer sends you an Authorization Form. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2065865">Fill out the Authorization Form, including the number of CPUs to use. For multi-CPU servers, include the </a>total number of CPUs.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2065862">Fax the filled-out form to Guidewire prior to issuing the license.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2065732">The Guidewire support engineer requests license keys from the appropriate departments.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="2065883">Once the license keys are obtained, Guidewire emails the designated customer contact (per the information on </a>the form) with the license information.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2068050">If you have additional questions about this process, email </a><span class="cv_-_computer_voice">support@guidewire.com</span>.</div>
      <div class="HS_-_Head_Sub"><a name="2065913">Configuration</a></div>
      <div class="B_-_Body"><a name="2065928">The default configuration appears in the Plugins registry in Studio.</a></div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="2084389">For information about using the plugins editor, see </a><a href="javascript:WWHClickedPopup('config', 'studio_plugins.13.1.html#1178213', '');" title="Using the Plugins Editor">“Using the Plugins Editor”</a>.</div>
      <div class="B_-_Body"><a name="2084385">Set the Java class to </a><span style="font-family: &quot;Lucida Sans Typewriter&quot;; font-size: 7.0pt">com.guidewire.pl.plugin.document.internal.BFOMergeHandler</span> and the following two parameter values:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2084427">Parameter </a><span class="cv_-_computer_voice">BatchServerOnly</span> set to <span class="cv_-_computer_voice">true</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="2101585">Parameter </a><span class="cv_-_computer_voice">LicenseKey</span> set to your server key. The <span class="cv_-_computer_voice">LicenseKey</span> value is empty in the default shipped configuration, since you must acquire your own BFO licenses from customer support. The <span class="cv_-_computer_voice">BatchServerOnly</span> parameter determines whether PDF generation happens on each server or solely on the batch server. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2101589">ClaimCenter uses this plugin interface only for templates that are configured to use server-side PDF generation </a>in the <span class="cv_-_computer_voice">IDocumentProduction</span> configuration. In other words, only templates set to use the class <span class="cv_-_computer_voice">ServerSidePDFDocumentProductionImpl</span>. Client-side PDF document production never uses the BFO library.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>