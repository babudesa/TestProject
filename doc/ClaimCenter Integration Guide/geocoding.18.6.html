<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Getting Driving Directions</title>
    <link rel="StyleSheet" href="css/geocoding.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="geocoding.18.1.html#2061833">Geographic Data Integration</a> : <a class="WebWorks_Breadcrumb_Link" href="geocoding.18.4.html#2061833">Writing a Geocoding Plugin</a> : Getting Driving Directions</span></div>
    <hr align="left" />
    <blockquote>
      <div class="H2B_-_Heading_2_Break"><a name="2061833">Getting Driving Directions</a></div>
      <div class="B_-_Body"><a name="2114238">ClaimCenter and ContactCenter optionally can display driving directions and other travel information. You can </a>support this by implementing these methods on the <span class="cv_-_computer_voice">GeocodePlugin</span> interface: </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="cv_-_computer_voice"><a name="2059589">getDrivingDirections</a></span> - Get driving directions based on a start address and a destination address, as well as a switch that specifies miles or kilometers.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="cv_-_computer_voice"><a name="2059610">pluginSupportsDrivingDirections</a></span> - Return <span class="cv_-_computer_voice">true</span> from this simple method</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2063682">Driving directions are enabled by default if you have geocoding enabled in the user interface. To disable driving </a>directions even in cases in which geocoding is enabled, you must edit the relevant PCF pages. </div>
      <div class="B_-_Body"><a name="2059614">It is important to understand that ClaimCenter does </a><span class="e_-_emphasis">not</span> require that the driving directions request be handled by the same external service as geocoding requests. If desired, the plugin could contact different services for these types of requests. </div>
      <div class="B_-_Body"><a name="2114243">The interface for driving directions is a single method called </a><span class="cv_-_computer_voice">getDrivingDirections</span>. If the user requests driving directions, ClaimCenter calls the geocoding plugin method <span class="cv_-_computer_voice">getDrivingDirections</span> once for each request. From a programming perspective, the method and the request are <span class="e_-_emphasis">synchronous</span> in the sense that the method must not return until the request is complete. However, from a user perspective it may seem <span class="e_-_emphasis">asynchronous</span> because ClaimCenter may request multiple driving directions requests without showing them to the user immediately. For example, ClaimCenter may request directions from one insured’s home address to nine different auto repair shops in preparation for users to request a map for one of them.</div>
      <div class="B_-_Body"><a name="2071624">This method takes two </a><span class="cv_-_computer_voice">Address</span> entities. The method must send these addresses to a remote driving directions service and return the results. If driving time and a map illustrating the route between the two addresses are available, the method returns those also. </div>
      <div class="B_-_Body"><a name="1934833">Address properties already include values for latitude and longitude before calling the plugin. Because some </a>services use only the latitude and longitude, driving directions can be to or from an inexact address such as a postal code rather than exact addresses. </div>
      <div class="B_-_Body"><a name="2060964">The plugin must return a </a><span class="cv_-_computer_voice">DrivingDirections</span> object that encapsulates the results. This class is in the <span class="cv_-_computer_voice">gw.api.contact</span> package namespace. To create one, you have two options.</div>
      <div class="B_-_Body"><a name="2063733">You can directly create a new driving directions object:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="2063734">var dd = new DrivingDirections()</a></div>
      <div class="B_-_Body"><a name="2063735">Alternatively, you can use a helper method to initialize the object:</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="2060979">uses gw.api.geocode.GeocodeUtils</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2062736">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2062737">var dd = GeocodeUtils.createPreparedDrivingDirections(startAddress, endAddress, unitOfDist)</a></PRE>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="2096743">The driving directions object is implemented as a Guidewire internal Java class, </a><span class="e_-_emphasis">not</span> a Guidewire entity. This distinction is important, because you cannot extend its data model.</div>
      <div class="H3_-_Heading_3"><a name="2096744">Retrieving Overview Maps</a></div>
      <div class="B_-_Body"><a name="2063769">If your geocoding or routing service supports overview maps, first implement the method </a><span class="cv_-_computer_voice">pluginReturnsOverviewMapWithDrivingDirections</span> to return <span class="cv_-_computer_voice">true</span>.</div>
      <div class="B_-_Body"><a name="2063770">Next, set the following properties on the driving directions object.</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="2062244">MapOverviewUrl</a></span> – a URL of the overview map shows the entire journey, as a <span class="cv_-_computer_voice">MapImageUrl</span> object, which is a simple object containing two properties:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="cv_-_computer_voice"><a name="2062245">MapImageUrl</a></span> – A fully-formed and valid URL string</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="cv_-_computer_voice"><a name="2062246">MapImageTag</a></span> – The text of the best HTML image element (in other words, an HTML <span class="cv_-_computer_voice">&lt;IMG&gt;</span> tag) that properly displays this map. This text may include, for example, the <span class="cv_-_computer_voice">height</span> and <span class="cv_-_computer_voice">width</span> attributes of the map, if they are known.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="2063776">hasMapOverviewUrl</a></span> – Set to <span class="cv_-_computer_voice">true</span> if there is a URL of the overview map shows the entire journey</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2063746">For example:</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="2063747">dd.MapOverviewUrl = new MapImageUrl()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2063753">dd.MapOverviewUrl.MapImageUrl = "http://myserver/mapengine?lat=3.9&amp;long=5.5"</a></PRE>
      <div class="B_-_Body"><a name="2114260">If you want to know how map data is used in the ClaimCenter user interface, see the PCF file </a><span class="cv_-_computer_voice">AddressBookDirectionsDV.pcf</span>.</div>
      <div class="H3_-_Heading_3"><a name="2062428">Adding Segments of the Journey with Optional Maps</a></div>
      <div class="B_-_Body"><a name="2062429">If you want to provide actual driving directions, you must also add driving directions elements that represent the </a>segments of the journey.</div>
      <div class="B_-_Body"><a name="2063730">Each </a><span class="cv_-_computer_voice">DrivingDirections</span> object contains various properties that relate to the entire journey, and it contains a list of journey segments in the form of an array of <span class="cv_-_computer_voice">DrivingDirectionsElem</span> objects. Each object in the array represents one segment, such as “Turn right on Main Street and drive 40 miles”. Many properties are set automatically if you use <span class="cv_-_computer_voice">createPreparedDrivingDirections</span> as described earlier. </div>
      <div class="B_-_Body"><a name="2062206">For each new segment, you do not need to create </a><span class="cv_-_computer_voice">DrivingDirectionsElem</span> directly, instead call the <span class="cv_-_computer_voice">addNewElement</span> method on the <span class="cv_-_computer_voice">DrivingDirections</span> object:</div>
      <div class="CS_-_Code_Single_Line"><a name="2061108">drivingdirections.addNewElement(String formattedDirections, Double distance, Integer duration)</a></div>
      <div class="B_-_Body"><a name="2062338">The </a><span class="cv_-_computer_voice">formattedDirections</span> object may represent either a discrete stage in the directions, such as <span class="cv_-_computer_voice">"Turn left </span><span class="cv_-_computer_voice">onto I-80 for 10 miles"</span>. It may represent a note or milestone not corresponding to a stage, such as <span class="cvt_-_computer_voice_table">"</span><span class="cv_-_computer_voice">Start </span><span class="cv_-_computer_voice">trip"</span>. The exact format and content of the textual description depends greatly on your geocoding service. It may or may not include HTML formatting.</div>
      <div class="B_-_Body"><a name="2062339">If your service supports multiple individual maps other than the overview, repeatedly call the method </a><span class="cv_-_computer_voice">addNewMapURL(</span><span class="ps_-_parameter_in_code_snippets">urlString</span><span class="cv_-_computer_voice">)</span> on the driving directions object to add URLs for maps. There is no requirement for the number of maps to match the number of segments of the journey. The position in the map URL list does not have a fixed correspondence to a segment number. However, always add map URLs in chronological order for the journey. In other words, generate the segments in the expected order from the start address to the end address.</div>
      <div class="B_-_Body"><a name="2062317">If you add individual maps like this, also implement the method </a><span class="cv_-_computer_voice">pluginReturnsStepByStepMapsWithDrivingDirections</span> to return <span class="cv_-_computer_voice">true</span>.</div>
      <div class="H3_-_Heading_3"><a name="2062360">Extracting Data from Driving Directions in PCF Files</a></div>
      <div class="B_-_Body"><a name="2063847">If you want to extract information from </a><span class="cv_-_computer_voice">DrivingDirections</span> in PCF code or other Gosu code, be aware there are properties you can extract, such as <span class="cv_-_computer_voice">TotalDistance</span>, <span class="cv_-_computer_voice">TotalTimeInMinutes</span>, <span class="cv_-_computer_voice">GCDistance</span>, and <span class="cv_-_computer_voice">GCDistanceString</span>. Methods with “GC” in the name refer to the great circle and great circle distance, which is the distance between two points on the surface of a sphere. It is measured along a path on the surface of the Earth’s curved 3D surface, in contrast to point-to-point through the Earth’s interior. </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="2063890">In Gosu, the address entity contains utility methods for calculating great circle distances. For </a>example, <span class="cv_-_computer_voice">address.getDistanceFrom( latitudeValue, longitudeValue )</span></div>
      <div class="B_-_Body"><a name="2063848">The </a><span class="cv_-_computer_voice">description</span> properties from the start and end addresses are also copied into the <span class="cv_-_computer_voice">Start</span> and <span class="cv_-_computer_voice">Finish</span> properties on <span class="cv_-_computer_voice">DrivingDirections</span>. </div>
      <div class="B_-_Body"><a name="2063908">Refer to the Gosu API Reference in Studio for the full set of properties. </a></div>
      <div class="H3_-_Heading_3"><a name="1927959">Error Handling</a></div>
      <div class="B_-_Body"><a name="2062366">If the plugin fails to connect to the external geocoding service, throw the exception </a><span class="cv_-_computer_voice">java.rmi.RemoteException</span>.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>