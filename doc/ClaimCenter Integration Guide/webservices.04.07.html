<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Calling Your Web Service from Microsoft .NET (WSE 3.0)</title>
    <link rel="StyleSheet" href="css/webservices.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="webservices.04.01.html#3433621">Web Services (SOAP)</a> : Calling Your Web Service from Microsoft .NET (WSE 3.0)</span></div>
    <hr align="left" />
    <blockquote>
      <div class="H1_-_Heading_1"><a name="3433621">Calling Your Web Service from Microsoft .NET (WSE 3.0)</a></div>
      <div class="B_-_Body"><a name="3435242">You can call your web service from Microsoft .NET with WSE 3.0 releases of .NET.</a></div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3435245">This section is about WSE 3.0. For connection from older WSE 2.0 systems, see the </a>next section <a href="javascript:WWHClickedPopup('integration', 'webservices.04.08.html#3434585', '');" title="Calling Your Web Service from Microsoft .NET (WSE 2.0)">“Calling Your Web Service from Microsoft .NET (WSE 2.0)”</a>.</div>
      <div class="B_-_Body"><a name="3433082">The syntax of different .NET languages varies widely, so there is no single syntax this documentation can use for </a>.NET examples. This section uses Microsoft Visual Basic examples.</div>
      <div class="HS_-_Head_Sub"><a name="3433089">To create a .NET connection to web services:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><span class="ri_-_run_in_header"><a name="3433091">Decide what interfaces you want.</a></span> You need <span class="cv_-_computer_voice">ILoginAPI</span> to log in. Choose other API interfaces based on what tasks you require.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3433092">Get a reference to interface objects.</a></span> This varies by language and SOAP implementation. Guidewire calls this a <span class="e_-_emphasis">handle</span> or <span class="e_-_emphasis">proxy</span> to the API.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3433650">Create a username token.</a></span> Create a WSS security token for your session. The details of this varies by language and SOAP implementation. See later in this topic for more detailed steps for Visual Basic .NET connections.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3433097">Log in.</a></span> Authenticate and log in with the <span class="cv_-_computer_voice">ILoginAPI</span> interface <span class="cv_-_computer_voice">WSSLogin</span> method. Pass it a name and password. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3433103">Associate the token with your interface proxies.</a></span> To permit each API interface to authenticate properly, associate each interface with your <span class="cv_-_computer_voice">UsernameToken</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3433105">Call your desired API functions.</a></span> Perform various functions to control, query, or add data to ClaimCenter using additional API interfaces. For example call methods on a web service interface you wrote in Gosu and exposed as a web service.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	7.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3433118">Log out.</a></span> Call the <span class="cv_-_computer_voice">ILoginAPI</span> interface <span class="cv_-_computer_voice">WSSLogout</span> method. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3433119">Guidewire strongly recommends you write error checking code. Be careful that your API client code always logs </a>out if your program finishes communicating with ClaimCenter. To log out, call the <span class="cv_-_computer_voice">WSSLogout</span> method on the <span class="cv_-_computer_voice">ILoginAPI</span> interface. </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3433131">Your code must always log out of ClaimCenter after it is done. Catch all errors and </a>exceptions. Carefully check that your code successfully logged in, it logs out before fully exiting.</div>
      <div class="B_-_Body"><a name="3433135">Because each program that calls ClaimCenter needs to log in to the server, create special ClaimCenter users that </a>represent systems rather than actual people. This help you track of where data came from. If you use different user IDs for different code, you can help debug problems because you know which code module imported the data. Remember to give this user identity sufficient roles and permissions to make the desired API calls. All API calls (except for logging in) require the <span class="cv_-_computer_voice">SOAPADMIN</span> permission. Some APIs specify additional required permissions.</div>
      <div class="B_-_Body"><a name="3433146">ClaimCenter supports plugins that can optionally manage </a><span class="e_-_emphasis">user authentication</span>. For details, see <a href="javascript:WWHClickedPopup('integration', 'authentication.12.5.html#1454403', '');" title="Deploying User Authentication Plugins">“Deploying User Authentication Plugins”</a>. </div>
      <div class="B_-_Body"><a name="3433181">Before you write code to call ClaimCenter APIs, set up your .NET development environment to work with the </a>SOAP interfaces. Import the WSDL for the ClaimCenter SOAP service into your .NET development environment. It makes a local representation of the data objects required by each ClaimCenter API. </div>
      <div class="B_-_Body"><a name="3433677">After setting up authentication and login, most web service API usage is straightforward. Guidewire provides an </a>alternative security approach based on the WS-Security standard, which Microsoft supports in .NET. </div>
      <div class="HS_-_Head_Sub"><a name="3433660">Connecting to Web Services from .NET with WSE 3.0</a></div>
      <div class="B_-_Body"><a name="3433200">Guidewire provides Visual Basic .NET sample code within the </a><span class="cv_-_computer_voice">ClaimCenter/soap-api/examples</span> directory. To use the included <span class="cv_-_computer_voice">DotNetAPISample</span> sample code:</div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><a name="3433202">First, confirm that Microsoft Web Services Enhancements 3.0 (WSE 3.0) is on your computer. If not, install it </a>and restart Visual Studio.NET</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433207">Open the project in Visual Studio.NET</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433208">Right-click on the name of the </a><span class="cv_-_computer_voice">DotNetAPISample</span> project to open the contextual menu for the project. It displays in bold text on the right side of the window .</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433209">From the contextual menu, choose </a><span class="ui_-_UI_element">WSE 3.0 Settings...</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3446183">Check the box next to </a><span class="ui_-_UI_element">Enable</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">this</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">project</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">for</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">Web</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">Services</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">Enhancements</span> </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3446184">Click </a><span class="ui_-_UI_element">OK</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	7.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433726">Confirm your ClaimCenter server is running. Test it in your web browser.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	8.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433729">Delete </a><span class="cv_-_computer_voice">ILoginAPI</span> and <span class="cv_-_computer_voice">ISystemToolsAPI</span> under <span class="ui_-_UI_element">Web References</span> from the right pane called <span class="ui_-_UI_element">Solution Explorer</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	9.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433730">Right-click on the </a><span class="cv_-_computer_voice">DotNetAPISample</span> project (the bold text) on the right side of the window to open the contextual menu.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	10.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433218">From the contextual menu, click </a><span class="ui_-_UI_element">Add Web Reference...</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	11.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433220">Enter the URL to the login interface WSDL. It looks something like:</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line" style="font-style: normal; font-variant: normal; font-weight: normal; text-transform: none; vertical-align: baseline"><span class="cv_-_computer_voice"><a name="3446217">http://localhost:8080/cc/soap/ILoginAPI?wsdl</a></span></div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	12.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3446219">For the </a><span class="ui_-_UI_element">Web Reference</span> name, type <span class="cv_-_computer_voice">ILoginAPI</span> and then click the <span class="ui_-_UI_element">Add Reference</span> button.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	13.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3446221">Check for a Microsoft WSE Service Proxy bug that sometimes manifests at this step. Visual Studio has a </a>known bug that sometimes manifests to prevent proper creation of the WSE service proxy. If the bug manifests, then only the traditional service generates and not the service with the <span class="cv_-_computer_voice">WseService</span> extension.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LS2A_-_List_Start_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS2A_-_List_Start_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">a.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS2A_-_List_Start_002c_Level_2_Alpha_inner"><a name="3434504">Double-click on the web reference for the new API, in this case </a><span class="cv_-_computer_voice">ILoginAPI</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">b.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3434505">In the Object Browser pane on the left, view the list of elements of the definition of your new interface </a>you imported.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">c.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3434506">Find the service, which is the API name followed by the string </a><span class="cv_-_computer_voice">Service</span>. In this case, search for <span class="cv_-_computer_voice">ILoginAPIService</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">d.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3433766">Double-click on that service.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">e.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3433816">In the source code that appears called </a><span class="cv_-_computer_voice">reference.cs</span>, find the line:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="3433817">&nbsp;</a>&nbsp;&nbsp;public partial class IUserAPIService : System.Web.Services.Protocols.SoapttpClicentProtocol {</div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">f.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3433818">Check if this line already contains the string </a><span class="cv_-_computer_voice">Microsoft.Web.Services3.WebServicesClientProtocol</span>. If it does not, change it to extend the service from <span class="cv_-_computer_voice">Microsoft.Web.Services3.WebServicesClientProtocol</span> instead. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP2_-_List_Para_002c_Level_2"><a name="3446262">For example, change this line to:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="3433791">&nbsp;</a>&nbsp;&nbsp;public partial class IUserAPIService : <span class="s_-_strong">Microsoft.Web.Services3.WebServicesClientProtocol</span> {</div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">g.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3433801">Save the file.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3433830">If you ever update the web reference in Studio, you must repeat this workaround. For </a>example, suppose your server name or port changes. If you return to the Solutions Explorer pane and update the web reference URL for the WSDL, the .NET environment redownloads the WSDL and regenerate the service. This redownloading removes your changes. You must repeat this procedure.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	14.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3434443">Right-click on the </a><span class="cv_-_computer_voice">DotNetAPISample</span> project, which is the bold text on the right side of the window. It opens the contextual menu.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	15.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3446290">Click </a><span class="ui_-_UI_element">Add Web Reference...</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	16.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3434471">Enter the URL to another SOAP API interface, such as the system tools interface WSDL:</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line" style="font-style: normal; font-variant: normal; font-weight: normal; text-transform: none; vertical-align: baseline"><span class="cv_-_computer_voice"><a name="3433232">http://localhost:8080/cc/soap/ISystemToolsAPI?wsdl</a></span></div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	17.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433234">For the web reference name, type </a><span class="cv_-_computer_voice">ISystemToolsAPI</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	18.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3446296">Click the </a><span class="ui_-_UI_element">Add Reference</span> button.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	19.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433843">Check for the WSE Service Proxy bug (see </a><a href="javascript:WWHClickedPopup('integration', 'webservices.04.07.html#3446221', '');" title="Calling Your Web Service from Microsoft .NET (WSE 3.0)">step 13</a>).</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	20.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3438665">If you use WSE3 and your code assumes WSE 2.0, you must update </a><span class="cv_-_computer_voice">imports</span> statements in your .NET code to reference version 3 libraries, not version 2 libraries. For example, the included sample code in ClaimCenter requires the following changes at the top of the file to change the number 2 to the number 3. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="3446299">Find each line such as:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="3433872">Imports Microsoft.Web.Services</a><span class="s_-_strong">2</span></div>
      <div class="LP_-_List_Para"><a name="3446314">Change them to:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="3446315">Imports Microsoft.Web.Services</a><span class="s_-_strong">3</span></div>
      <div class="LP_-_List_Para"><a name="3446316">In the example, there are three such lines.</a></div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	21.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433904">If you use WSE3 and your code assumes WSE 2.0, you must ensure that the name of the service does not </a>have the <span class="cv_-_computer_voice">Wse</span> suffix. For example, if you use the included example, change the line:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="3433915">Dim loginAPI As New ILoginAPI.ILoginAPIServiceWse</a></div>
      <div class="LP_-_List_Para"><a name="3433919">To the following:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="3433924">Dim loginAPI As New ILoginAPI.ILoginAPIService</a></div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	22.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433931">Set up a Username Token. Your web service client passes the </a><span class="cv_-_computer_voice">UsernameToken</span> as an authentication credential to the server with every SOAP call. You only need to do this once. After that, use the authentication credential, which is typically more secure, instead of a plaintext password. For example:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CF_-_Code_First_Line"><a name="3433941">Dim credentials As New UsernameToken("su", "gw", PasswordOption.SendHashed)</a></PRE>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	23.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433240">Write your code to connect with the .NET authentication using the </a><span class="cv_-_computer_voice">ILoginAPI</span> interface’s <span class="cv_-_computer_voice">WSSlogin</span> method. The login method <span class="cv_-_computer_voice">WSSLogin</span> is part of the Guidewire implementation of the <span class="cv_-_computer_voice">UsernameToken</span> profile of the Web Services Security specification. Support for this specification is part of the WSE package from Microsoft. The next step might look like:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CM_-_Code_Middle_Line"><a name="3433251">loginAPI.WSSLogin("su", "gw")</a></PRE>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	24.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433993">In Studio.NET, set up what Microsoft calls a </a><span class="e_-_emphasis">security policy</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3434006">What Microsoft .NET calls a </a><span class="e_-_emphasis">security</span><span class="e_-_emphasis">&nbsp;</span><span class="e_-_emphasis">policy</span> is unrelated to a <span class="e_-_emphasis">policy</span> in the context of the Guidewire data model. Be careful not to confuse these two meanings of the term. A Microsoft .NET security policy represents an abstraction of the security you use to connect to a service. In the case of Guidewire applications, the security policy is simple, and uses the name/password authentication embedded in the <span class="cv_-_computer_voice">UsernameToken</span> object.</div>
      <div class="LS2A_-_List_Start_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS2A_-_List_Start_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">a.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS2A_-_List_Start_002c_Level_2_Alpha_inner"><a name="3434026">Go to the Solution Explorer pane and right-click on the project name.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LS2A_-_List_Start_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS2A_-_List_Start_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">a.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS2A_-_List_Start_002c_Level_2_Alpha_inner"><a name="3434035">From the contextual menu, choose </a><span class="ui_-_UI_element">WSE 3.0 Settings...</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">b.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446361">Select the </a><span class="ui_-_UI_element">Policy</span> tab.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">c.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3434055">Click </a><span class="ui_-_UI_element">Add...</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">d.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3434059">In the dialog that says </a><span class="ui_-_UI_element">Add or Modify Policy Friendly Name</span>, enter the name <span class="cv_-_computer_voice">ClientPolicy</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">e.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446369">Click </a><span class="ui_-_UI_element">OK</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">f.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446370">In the </a><span class="ui_-_UI_element">WSE Security Settings Wizard</span> that appears, for the top question in the wizard, click <span class="ui_-_UI_element">Secure</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">a</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">service</span><span class="ui_-_UI_element">&nbsp;</span><span class="ui_-_UI_element">application</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">g.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446384">For the authentication method, click </a><span class="ui_-_UI_element">Username.</span> </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">h.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446401">Click </a><span class="ui_-_UI_element">Next</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">i.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3434091">In the next screen, leave the checkbox </a><span class="ui_-_UI_element">Specify Username Token in Code</span> checked.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">j.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446405">Click </a><span class="ui_-_UI_element">Next</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">k.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3434100">In the next screen, check </a><span class="ui_-_UI_element">Enable WS-Security 1.1 Extensions</span>. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">l.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446409">Click the protection order </a><span class="ui_-_UI_element">None</span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI2A_-_List_Item_002c_Level_2_Alpha_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">m.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI2A_-_List_Item_002c_Level_2_Alpha_inner"><a name="3446411">Click </a><span class="ui_-_UI_element">Finish</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	25.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3434210">In your code, set your client credential with .NET code using the security policy name that you defined </a>earlier. Do this for every API interface that you plan to use, including <span class="cv_-_computer_voice">ILoginAPI</span>. You use <span class="cv_-_computer_voice">ILoginAPI</span> later for the log out process. The following example demonstrates setting the .NET security policy:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CF_-_Code_First_Line"><a name="3434211">‘ set client credential for ILoginAPI...</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3434212">loginAPI.SetClientCredential(userToken)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3434178">loginAPI.SetPolicy("ClientPolicy")</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3434205">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3434206">‘ use additional API interfaces to do your actual work...</a></PRE>
      <div class="CS_-_Code_Single_Line"><a name="3434194">Dim systoolsAPI As New ISystemToolsAPI.ISystemToolsAPIService</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="3434182">systoolsAPI.SetClientCredential(userToken)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3434183">systoolsAPI.SetPolicy("ClientPolicy")</a></PRE>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	26.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3433992">Call any desired API methods. You do not need to worry SOAP protocol details. For example, to get the </a>ClaimCenter server’s current <span class="e_-_emphasis">run level</span>, use code such as:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CM_-_Code_Middle_Line"><a name="3434142">Dim runlevel As ISystemToolsAPI.SystemRunlevel</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3434143">runlevel = systoolsAPI.getRunlevel()</a></PRE>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	27.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><a name="3434144">&nbsp;</a>Log out after you are done:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CL_-_Code_Last_Line"><a name="3434146">loginAPI.WSSLogout("su")</a></PRE>
      <div class="B_-_Body"><a name="3433278">Be aware that an authentication credential is not as secure as SSL-encrypted authentication or transport-level </a>strong encryption. For additional security, make your initial connection request the username token over a secure sockets layer (SSL) connection using an <span class="cv_-_computer_voice">https</span> URL instead of an <span class="cv_-_computer_voice">http</span> URL. For more information about configuring secure sockets layer and its performance implications, see the <span class="bt_-_book_title">ClaimCenter Configuration Guide</span>. </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="3447155">After the initial connection, you can choose to login and connect to the web service APIs over regular </a>(non-SSL) connections. Although the data transport is not encrypted in either direction over a non-SSL connection, your password is safe from interception. Your password is safe because the only time the password was sent to the server, the password was hashed and passed over a secure socket layer. For maximum security, connect to the ClaimCenter server over full SSL connections.</div>
      <div class="B_-_Body"><a name="3446650">Note the following things about using web service objects from .NET: </a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3446660">The package hierarchy appears such that objects appear in their interface’s namespace. For example, the </a>Javadoc may show an entity with the package symbol as <span class="cv_-_computer_voice">com.guidewire.cc.webservices.entity.Note</span>. However, if an API interface called <span class="cv_-_computer_voice">IMyAPI</span> uses this object as a return result or parameter, it appears as <span class="cv_-_computer_voice">IMyAPI.Note</span> from within .NET. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3446674">If another API interface uses that object, it appears as a separate object within that API proxy’s scope. Be </a>careful to use the variant of the object in the correct namespace for the API that you call.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="3446675">The API Reference Javadoc documentation was produced from tools that process the Java version of the </a>ClaimCenter APIs. Consequently, some information is Java-centric and it appears different if using .NET. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3434584">Refer to the included </a><span class="cv_-_computer_voice">DotNetAPISample</span> sample for a working Visual Basic .NET example.</div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3440633">The included </a><span class="cv_-_computer_voice">DotNetAPISample</span> requires minor modifications to work with WSE&nbsp;3.0. Carefully read the procedure earlier in the section and note the items that mention differences between WSE&nbsp;2.0 and WSE&nbsp;3.0.</div>
      <div class="HS_-_Head_Sub"><a name="3435339">Multi-Dimensional Arrays and .NET SOAP Access</a></div>
      <div class="B_-_Body"><a name="3435340">Microsoft .NET does not properly import WSDL describing multi-dimensional arrays. As a consequence, there </a>is an additional step necessary to use multi-dimensional arrays. </div>
      <div class="B_-_Body"><a name="3435341">For example, suppose a SOAP API returns a two-dimensional array of </a><span class="cv_-_computer_voice">String</span> objects. In other words, it returns an object of type <span class="cv_-_computer_voice">String[][]</span>. As Microsoft .NET imports the WSDL and generates the method signature in the native .NET environment for that language, it misconverts the type. The .NET environment inappropriately converts it to a single-dimensional array, such as <span class="cv_-_computer_voice">String[]</span> instead of <span class="cv_-_computer_voice">String[][]</span>.</div>
      <div class="B_-_Body"><a name="3435342">To work around this issue, first import the WSDL into Visual Studio. Afterward, update the generated method </a>signature to access the proper multi-dimensional object, such as <span class="cv_-_computer_voice">String[][]</span> instead of <span class="cv_-_computer_voice">String[]</span>.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>