<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Messaging Overview</title>
    <link rel="StyleSheet" href="css/eventsmessaging.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>ClaimCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="eventsmessaging.10.01.html#2961060">Messaging and Events</a> : Messaging Overview</span></div>
    <hr align="left" />
    <blockquote>
      <div class="H1_-_Heading_1"><a name="2961060">Messaging Overview</a></div>
      <div class="B_-_Body"><a name="2270159">To understand this topic, it may help to get a high-level overview of terminology and an overview of events in </a>ClaimCenter. The following table summarizes terminology regularly used in this topic:</div>
      <div class="T_-_Table"><a name="3749019">&nbsp;</a></div>
      <table class="withHeading" style="text-align: left" cellspacing="10" summary="">
        <caption></caption>
        <tr>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: bottom">
            <div class="TH_-_Table_Heading"><a name="3748967">Term</a></div>
          </td>
          <td style="border-bottom-color: #000000; border-bottom-style: solid; border-bottom-width: 1px; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: bottom">
            <div class="TH_-_Table_Heading"><a name="3748969">Description</a></div>
          </td>
        </tr>
        <tr>
          <td style="border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748971">event</a></div>
          </td>
          <td style="border-top-color: #000000; border-top-style: solid; border-top-width: 1px; padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="4041759">An abstract notification of a change in ClaimCenter that might be interesting to an exter</a>nal system. For example, adding, changing, or removing a Guidewire entity.</div>
            <div class="TT_-_Table_Text"><a name="4323317">For example, adding a new financial transaction on a claim.</a></div>
            <div class="TT_-_Table_Text"><a name="3754052">&nbsp;</a></div>
          </td>
        </tr>
        <tr>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748975">message</a></div>
          </td>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748979">Information to send to an external system in response to an event. ClaimCenter can </a>send one or more (different) messages to each destination interested in an event. In addition to an ID and some status information, each message has a payload, which is the main data content of the message.</div>
          </td>
        </tr>
        <tr>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748982">messaging destination</a></div>
          </td>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748984">An external system to which to send messages. Register your messaging destinations </a>in Studio and specify which classes implement your messaging plugins for that destination. Register exactly one destination for each external system. Each destination registers a list of events for which it wants notifications. Each destination may listen for different events compared to other destinations.</div>
          </td>
        </tr>
        <tr>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748986">acknowledgement</a></div>
          </td>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748988">A response to a ClaimCenter message that indicates successful message processing. </a>This could be a <span class="e_-_emphasis">positive acknowledgement </span>(Ack) that means that the external system processed the message successfully. It could also be a negative acknowledgement (Nack) that means the external system could not handle the message due to some error.</div>
          </td>
        </tr>
        <tr>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="3748997">safe ordering</a></div>
          </td>
          <td style="padding-bottom: 2pt; padding-left: 2pt; padding-right: 8pt; padding-top: 2pt; vertical-align: top">
            <div class="TT_-_Table_Text"><a name="4323328">ClaimCenter always sends messages associated with claims ordered by claim for each </a>messaging destination. These are <span class="e_-_emphasis">safe-ordered </span>messages. There are other types of messages, such as Catastrophe, that are <span class="e_-_emphasis">non-safe-ordered</span> messages.</div>
            <div class="TT_-_Table_Text"><a name="4320806">ClaimCenter waits for an acknowledgement from each destination before processing </a>the next safe-ordered message for a claim.</div>
            <div class="TT_-_Table_Text"><a name="4320810">In contrast, ClaimCenter sends non-safe-ordered messages for each destination in </a>send, or creation, order and does <span class="e_-_emphasis">not</span> wait for acknowledgements before sending the next one.</div>
            <div class="TT_-_Table_Text"><a name="3977991">For details, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.07.html#4043039', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
          </td>
        </tr>
      </table>
      <div class="B_-_Body"><a name="3012350">The high-level steps of event and message generation and processing are as follows. </a>As an example for this list, let us suppose you want to detect new checks so you can send the information to a check printing system.</div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><span class="ri_-_run_in_header"><a name="3749103">Application startup and destination setup.</a></span> At application startup, ClaimCenter checks its configuration information and constructs abstract <span class="e_-_emphasis">destinations</span>, each of which represents an external system that can receive a message. As part of this destination setup, each destination registers for specific events for which it wants notifications. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4320921">In the earlier example, the destination registers for the </a><span class="cv_-_computer_voice">CheckAdded</span> and <span class="cv_-_computer_voice">CheckChanged</span> events.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3716048">System events trigger destination events.</a></span> Events trigger after data changes. For example, if you change data in the user interface, if an outside system calls a web service that changes data, or a time-delayed event changes data. The system event represents the changes to application data as the entity commits to the database.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4320926">Event Fired rule set runs and your rules create messages.</a></span> ClaimCenter runs the Event Fired rule set for each event name that triggers (and runs multiple times for an event anme if multiple destinations listen for it). Your rules can choose to generate new messages. Messages have a text-based <span class="e_-_emphasis">message payload</span>. In the earlier example, you might write rules that check if the event name is <span class="cv_-_computer_voice">CheckAdded</span> or <span class="cv_-_computer_voice">CheckChanged</span>, and if certain other conditions occur. If so, the rules generate a new message with an XML payload that describes the added check. The rules might also link entities with the message for later use.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4320943">ClaimCenter sends message to a destination.</a></span> Messages are put in a queue and handed one-by-one to the <span class="e_-_emphasis">messaging</span><span class="e_-_emphasis">&nbsp;</span><span class="e_-_emphasis">destination</span>. In the earlier example, the checking printing destination might take an XML payload and submit it to a JMS queue to notify an external system about the check.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4320950">ClaimCenter waits for an acknowledgement.</a></span> The check printing system replies with an acknowledgement to the destination after it processes the message. In turn, the destination informs ClaimCenter of the acknowledgement. In the earlier example, the check printing system might send an acknowledgement (reply) message on a reply queue once it had printed the check. In turn, the destination would notify ClaimCenter in an <span class="e_-_emphasis">acknowledgement </span>that the check message succeeded (or failed). The code that submits the acknowledgement might also make changes to application data, such as updating a property on a <span class="cv_-_computer_voice">Claim</span> entity.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="3019271">ClaimCenter makes no assumptions about the final message format or system. Instead ClaimCenter relies on the </a>messaging plugins that represent the destination to respond with an appropriate <span class="e_-_emphasis">acknowledgement</span>. The acknowledgment indicates that the destination system handled the message. A <span class="e_-_emphasis">negative acknowledgement</span> indicates failure on the receiving system’s end of the communication.</div>
      <div class="B_-_Body"><a name="3656712">The bulk of integration code using events and messaging is designing Event Fired rules to create message </a>payloads and writing a <span class="cv_-_computer_voice">MessageTransport</span> plugin to send it. There are two other types of messaging plugins that are optional, which this topic discusses later.</div>
      <div class="B_-_Body"><a name="3656743">Once you have written your code that implements your messaging plugin, register your new messaging plugins </a>in Studio. As you registering new plugins in Studio, Studio prompts you for a plugin interface name (in a picker) and in some cases a plugin name. Use that plugin name to configure the messaging destination in the Messaging editor to register each destination.</div>
      <div class="B_-_Body"><a name="3656858">For more information about registering a plugin, see </a><a href="javascript:WWHClickedPopup('config', 'studio_messaging.17.1.html#1178213', '');" title="Using the Messaging Editor">“Using the Messaging Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_messaging.17.1.html#1178213', '');" title="Using the Messaging Editor">Configuration Guide</a></span>. For more information about plugins in general, see <a href="javascript:WWHClickedPopup('integration', 'plugins.09.01.html#2013370', '');" title="Plugin Overview">“Plugin Overview”</a>.</div>
      <div class="B_-_Body"><a name="3656887">For more information about the Studio Messaging Editor, see </a><a href="javascript:WWHClickedPopup('config', 'studio_messaging.17.1.html#1178213', '');" title="Using the Messaging Editor">“Using the Messaging Editor” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('config', 'studio_messaging.17.1.html#1178213', '');" title="Using the Messaging Editor">Configuration Guide</a></span>. Also see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.03.html#3006454', '');" title="Message Destination Overview">“Message Destination Overview”</a> later in this topic.</div>
      <div class="B_-_Body"><a name="3657077">ClaimCenter does not assume any specific type of transport. Destinations can deliver the message any way they </a>want, including but not limited to the following:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1441765">Submit the message to a guaranteed-delivery messaging system.</a></span> For instance, send to a Java Messaging Service (JMS) queue implemented with IBM WebSphere MQ middleware. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3012773">Submit the message using remote API calls.</a></span> Use a web service (SOAP) interface or a Java-specific interface to send a message to an external system.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1441774">Save to special files in the file system.</a></span> Message “sending” could be implemented by writing data to local text files that are read by nightly batch processes.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="3012761">Send e-mails.</a></span> The destination might send e-mails, which might not guarantee delivery or order, depending on the type of mail system. This approach is convenient for simple notifications but might not be appropriate for systems that rely on guaranteed delivery and message order. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H2_-_Heading_2"><a name="3036497">Event and Messaging Flow</a></div>
      <div class="B_-_Body"><a name="3036501">The following diagram illustrates the chronological flow events and messaging, starting from the top of the </a>diagram. Refer to the section following the diagram for a detailed explanation of each step.</div>
      <div class="F_-_Figure"><a name="3000525"><img class="Default" src="images/eventsmessaging.10.02.1.png" style="display: inline; float: none; left: 0.0; top: 0.0" alt="" /></a></div>
      <div class="B_-_Body"><a name="1441874">The following list describes a detailed chronological flow of event-related actions:</a></div>
      <div class="LS_-_List_Start_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LS_-_List_Start_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LS_-_List_Start_inner"><span class="ri_-_run_in_header"><a name="1441878">Destination initialization at system startup.</a></span> After the ClaimCenter application server starts, the application initializes all destinations. ClaimCenter saves a list of events for which each destination requested notifications. Because this happens at system startup, if you change the list of events or destination, you must restart ClaimCenter. Each destination encapsulates all the necessary behavior for that external system, but uses three different plugin interfaces to implement the destination. Each plugin handles different parts of what a destination does. The message request plugin handles message pre-processing. The message transport plugin handles message transport, and the message reply plugin handles message replies.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="3655067">Register new messaging plugins in Studio first in the Plugins editor. When you create a new implementation, </a>Studio prompts you for a plugin interface name (in a picker) and in some cases a plugin name. Use that plugin name in the Messaging editor in Studio to register each destination. Remember that you need to register your plugin in two different editors in Studio.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3753811">A user (or an API call) changes something.</a></span><span class="s_-_strong" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 10.0pt; font-style: normal"> </span>An action in the application user interface, an API call, a batch process, and even some background processes can change data in ClaimCenter.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4320965">For example, ClaimCenter triggers an event if you add an exposure to a claim, add a note to anything, or issue </a>a payment. </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="4033820">It is critical to understand that the change does not fully commit to the database until </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#3570365', '');" title="Messaging Overview">step 5</a>. Any exceptions that occur before <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#3570365', '');" title="Messaging Overview">step 5</a> undoes the change that triggered the event. In other words, unless all follow-up actions to the change succeed, the database transaction rolls back. For related information, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.03.html#3961747', '');" title="Message Destination Overview">“Messaging Database Transactions During Sending”</a>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3531260">ClaimCenter generates (and duplicates) destination events. </a></span>The same action, such as a single change to the ClaimCenter database, might trigger <span class="e_-_emphasis">more</span> than one event. ClaimCenter checks whether each destination has listed each relevant event in its messaging configuration. For each messaging destination that listens for that event, ClaimCenter calls your Event Fired business rules. If multiple destinations want notifications for a specific event, ClaimCenter duplicates the event for each<span class="s_-_strong"> </span>destination that wants that event. To the business rules, these duplicates look the same except with different <span class="e_-_emphasis">destination</span><span class="e_-_emphasis">&nbsp;</span><span class="e_-_emphasis">ID</span> properties. It is critical to understand that a change to ClaimCenter data might generate events for one destination but not another destination. To change this list, review the Messaging editor in Studio for each destination.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	4.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="2996599">ClaimCenter invokes business rule sets for each event to generate messages.</a></span><span class="s_-_strong" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 10.0pt; font-style: normal"> </span>ClaimCenter calls the Event Fired rule set for each destination/event pair. Event-handling rule sets rules check the event name and the messaging destination to determine whether to send a message for that event. Your Event Fired rules generate messages using the Gosu method <span class="cv_-_computer_voice">messageContext.createMessage(</span><span class="ps_-_parameter_in_code_snippets">payload</span><span class="cv_-_computer_voice">)</span>. The rule actions choose whether to generate a message, the order of multiple messages, and the text-based message <span class="e_-_emphasis">payload</span>. For more information, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.06.html#3961690', '');" title="Generating New Messages in Event Fired Rules">“Generating New Messages in Event Fired Rules”</a>. Your rules can use the following techniques:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="4188438">Optionally export an entity to XML using Guidewire-standardized XSD format. </a></span>Studio includes a tool that helps you export business data entities (and other types like Gosu classes) to XML. You can select which properties are required or optional for each integration point. You can export an XSD to describe the data interchange format you selected. Then, you can edit your Event Fired rules to generate a payload for the entity that conforms to your custom XSD. For more details, see <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.06.html#3946979', '');" title="Generating New Messages in Event Fired Rules">“Creating XML Payloads Using Guidewire XML (GX ) Models”</a>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="4188577">The Guidewire XML (GX) modeler is a powerful tool for integrations. With it, you can </a>create custom XML models that contain only the subset of entity object data that is appropriate for each integration point. It can output a custom XSD that your external system can use. You can also use GX models to parse (import) XML data into in-memory objects that describe the XML structure. For import or export, GX models allow you to work with XML naturally in Gosu as objects and properties, rather than as text data. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.06.html#3946979', '');" title="Generating New Messages in Event Fired Rules">“Creating XML Payloads Using Guidewire XML (GX ) Models”</a>.</div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="4188445">Optionally use Gosu templates to generate the payload.</a></span><span class="s_-_strong" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 10.0pt; font-style: normal"> </span>Rules can optionally use templates with embedded Gosu to generate message content. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="1441913">Optionally use Java classes (called from Gosu) to generate the payload.</a></span><span class="s_-_strong" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 10.0pt; font-style: normal"> </span>Rules can optionally use Java classes to generate the message content from Gosu business rules.<span class="e_-_emphasis"> </span>See <a href="javascript:WWHClickedPopup('gosu', 'java-gosu.08.01.html#2005457', '');" title="Java and Gosu">“Java and Gosu” in the </a><span class="bt_-_book_title"><a href="javascript:WWHClickedPopup('gosu', 'java-gosu.08.01.html#2005457', '');" title="Java and Gosu">Gosu Reference Guide</a></span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI2_-_Bullet_Item_002c_Level_2_outer" style="margin-left: 67pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI2_-_Bullet_Item_002c_Level_2_inner"><span class="ri_-_run_in_header"><a name="4042029">Optional late binding.</a></span> You can use a technique called <span class="e_-_emphasis">late binding</span> to include parameters in a message payload at message creation time but evaluate them immediately before sending. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.08.html#3946497', '');" title="Late Binding Fields">“Late Binding Fields”</a> for details.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4237236">Event Fired rules and messaging plugin implementations have limitations about what data </a>you can change. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#4210337', '');" title="Messaging Overview">“Entity Data Restrictions in Messaging Rules and Messaging Plugins”</a>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	5.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3570365">New messages add to the send queue.</a></span> After all rules finish running, ClaimCenter adds any new messages to the send queue in the database. The submission of messages to the send queue is part of the same database transaction that triggered the event to preserve atomicity. In other words, if the transaction succeeds, all related messages successfully enter the send queue. If the transaction <span class="e_-_emphasis">fails</span>, the change rolls back including all messages added during that transaction.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4041958">Messages might wait in this queue for a while, depending on the state of acknowledgements</a> and the message writer’s assessment of safe ordering of messages, discussed in <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#4006012', '');" title="Messaging Overview">step 6</a>. </div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	6.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="4006012">On the batch server, each messaging destination thread pulls messages from the send queue.</a></span> </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4320984">Each destination reads messages from the send queue and dispatches them in the appropriate order to the </a>messaging plugins to send. Messages that are claim-related always send in <span class="e_-_emphasis">safe order</span>. Safe ordering guarantees there is never more than one message sent at one time for each claim/destination pair. </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="4005911">For details of how ClaimCenter retrieves messages and orders them for sending, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.07.html#4043039', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
      <div class="LP_-_List_Para"><a name="4041893">If the messaging destination sends a message, it calls the </a><span class="cv_-_computer_voice">send</span> method of the destination’s message transport plugin. The message transport plugin is responsible for sending the message in whatever native transport is appropriate. For example, it might submit a message to a queue, call a SOAP API, send SQL to a database, or write a file for later batch processing. ClaimCenter makes no assumptions about the native messaging format. The <span class="cv_-_computer_voice">send</span> method can throw exceptions to indicate that a retryable error occurred (try again later) or a non-retryable error occurred (stop messages to this destination). </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4237264">Event Fired rules and messaging plugin implementations have limitations about what data </a>you can change. See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#4210337', '');" title="Messaging Overview">“Entity Data Restrictions in Messaging Rules and Messaging Plugins”</a>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="ri_-_run_in_header">	7.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner"><span class="ri_-_run_in_header"><a name="3036519">Acknowledging messages.</a></span><span class="s_-_strong" style="color: #000000; font-family: &quot;Times New Roman&quot;; font-size: 10.0pt; font-style: normal"> </span>Some destination implementations know success or failure immediately during sending. For example, a messaging transport plugin might calls a synchronous remote procedure call on a destination system before returning from its <span class="cv_-_computer_voice">send</span> method.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4006165">In contrast, a messaging destination might need to wait for an </a><span class="e_-_emphasis">asynchronous</span> time-delayed reply from the destination to confirm that it processed the message successfully. For example, it might need to wait for an incoming message on a JMS messaging queue that confirmed the system processed that message. </div>
      <div class="LP_-_List_Para"><a name="4006205">In either case, the messaging destination code or the external system must confirm that the message arrived </a>safely by submitting an <span class="e_-_emphasis">acknowledgement</span> (an <span class="e_-_emphasis">Ack</span>) to ClaimCenter for that specific message. Alternatively, submit an error, also called a negative acknowledgement or <span class="e_-_emphasis">Nack</span>. You can submit an Ack or Nack in several places. For synchronous sending, submit it in your <span class="cv_-_computer_voice">MesssageTransport</span> plugin during the <span class="cv_-_computer_voice">send()</span> method. For asynchronous sending, submit it in your <span class="cv_-_computer_voice">MessageReply</span> plugin. For asynchronous sending, an external system could optionally use a SOAP API to submit an acknowledgement or error.</div>
      <div class="LP_-_List_Para"><a name="4320992">If using messaging plugins to submit the Ack, you can also make changes to data during the Ack, such as </a>updating properties on entities. For financials objects, acknowledgements of messages have special behavioral side effects, such as changing the status of a check. For more information, see <a href="javascript:WWHClickedPopup('integration', 'financials.11.01.html#3066382', '');" title="Financials Integration">“Financials Integration”</a>.</div>
      <div class="LI_-_List_Item_outer" style="margin-left: 57pt; margin-bottom: 2.0pt; margin-top: 5.0pt; vertical-align: baseline">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="LI_-_List_Item_inner" style="width: 15pt; white-space: nowrap;color: #000000; font-style: normal; font-variant: normal; font-weight: bold; text-transform: none">
                <span class="ri_-_run_in_header">	8.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="LI_-_List_Item_inner" style="color: #000000; font-style: normal; font-variant: normal; font-weight: bold; text-transform: none"><span class="ri_-_run_in_header"><a name="4319723">A message acknowledgement for safe-ordered messages permit sending the next related message.</a></span></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="LP_-_List_Para"><a name="4321006">If ClaimCenter gets an acknowledgement for a safe-ordered (claim-related) message, it potentially changes </a>what messages are now sendable. If there are other messages for that destination in the send queue for the same claim, ClaimCenter soon sends the <span class="s_-_strong">next</span> message for that claim. </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="4319728">For details of how messages are retrieved and ordered, see </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.07.html#4043039', '');" title="Message Ordering and Multi-Threaded Sending">“Message Ordering and Multi-Threaded Sending”</a>.</div>
      <div class="H2_-_Heading_2"><a name="4210337">Entity Data Restrictions in Messaging Rules and Messaging Plugins</a></div>
      <div class="B_-_Body"><a name="4210338">Event Fired rules and messaging plugin implementations have limitations about changing entity instance data. </a>Messaging code in these locations must perform only the minimal data changes necessary for integration on the message entity. Entity changes in these code locations do not rerun validation or pre-update rules, so you must not make changes that might require those rules to run again. </div>
      <div class="B_-_Body"><a name="4210339">Also, entity changes in messaging plugins do not trigger concurrent data exceptions except in some special cases. </a>See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.03.html#3961747', '');" title="Message Destination Overview">“Messaging Database Transactions During Sending”</a>. To avoid data integrity issues with concurrency, you must avoid changing data in these code locations.</div>
      <div class="B_-_Body"><a name="4210343">Specific rules for Event Fired rules and messaging plugin implementations:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4210344">For properties, only set messaging-specific properties and properties that users can never modify from the </a>user interface, even indirectly.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4210345">It is dangerous and unsupported to add new or delete objects in these code locations, even indirectly through </a>other APIs. The only exception is that you create new <span class="cv_-_computer_voice">Message</span> objects from Event Fired rules.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4210346">Do not call business logic APIs that might change entity data, since indirectly they could change, add, or </a>remove entity instances in violation of the earlier rules.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="4210347">For customer data integrity and server reliability, you must follow these restrictions </a>regarding what data you can change in Event Fired rules and messaging plugin implementations.</div>
      <div class="H2_-_Heading_2"><a name="3716365">Messaging Database Transactions During Message Creation</a></div>
      <div class="B_-_Body"><a name="3716372">All steps up to and including adding messages to the send queue (in the list earlier in this section, </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#3753811', '');" title="Messaging Overview">step 2</a> through <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#3570365', '');" title="Messaging Overview">step 5</a>) occur in one database transaction. This is the same database transaction that triggered the event. The database transaction rolls back if any of the following occur:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4151253">exceptions in rule sets before message creation</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4151280">exceptions after message creation but before commit the bundle to the database</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="4151271">errors committing the bundle to the database (this bundle includes new messages)</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="4151313">If any of these errors occur, ClaimCenter rolls back </a><span class="s_-_strong">all</span> messages added to the send queue in that transaction.</div>
      <div class="B_-_Body"><a name="3683560">Additionally, there are special rules about database transactions during message sending at the destination level. </a>See <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.03.html#3961747', '');" title="Message Destination Overview">“Messaging Database Transactions During Sending”</a>.</div>
      <div class="H2_-_Heading_2"><a name="4151357">Important Notes About ClaimCenter Clusters</a></div>
      <div class="B_-_Body"><a name="4151370">If you run ClaimCenter in a cluster, be aware that </a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#1441878', '');" title="Messaging Overview">step 1</a> through <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#3570365', '');" title="Messaging Overview">step 5</a> can occur on any ClaimCenter server within the cluster. ClaimCenter processes events on the same server as the user action or API call that triggered the event.</div>
      <div class="B_-_Body"><a name="4319787">Once a message is in the send queue (</a><a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#4006012', '');" title="Messaging Overview">step 6</a> through <a href="javascript:WWHClickedPopup('integration', 'eventsmessaging.10.02.html#4319723', '');" title="Messaging Overview">step 8</a>), any further action with the message occurs <span class="e_-_emphasis">only</span> on the batch server.</div>
      <div class="B_-_Body"><a name="3540455">Consequently, the batch server is the only server on which messaging plugins run. Configure your batch server </a>(and any backup batch servers) to communicate with your destination external systems. For example, remember to configure your firewalls accordingly including your backup batch servers.</div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="3006897">For ClaimCenter clusters, only the batch server actually uses your messaging plugins.</a></div>
      <div class="H2_-_Heading_2"><a name="3812734">Do Not Call SOAP APIs on the Same Server From Messaging Plugins</a></div>
      <div class="B_-_Body"><a name="3812735">In general, avoid calling locally-hosted SOAP APIs from within a plugin or the rules engine. Be careful about </a>any SOAP calls to the same server. If the SOAP API hosted locally modifies entity data and commits the bundle, the current transaction does not always detect and reload local data. </div>
      <div class="B_-_Body"><a name="3812736">Instead, refactor your code to avoid this case. For example, write a Gosu class that performs a similar function as </a>the web service but that does not commit the bundle. This type of refactoring also results in higher server performance. If you have questions about how to convert some particular use locally-hosted SOAP APIs from plugins or rules, contact Customer Support. </div>
      <div class="B_-_Body"><a name="3812737">This is true for all types of local loopback SOAP calls to the same server. This includes the </a><span class="cv_-_computer_voice">soap.local.*</span> Gosu APIs, the SOAP API libraries, and any Studio-registered web services that call the same server as the client.</div>
      <div class="B_-_Body"><a name="3812738">Those limitations are true for all plugin code. In addition, there are messaging-specific limitations with this </a>approach. Specifically, ClaimCenter locks the root entity for the message in the database. Any attempts to modify this entity from outside your messaging plugin (and SOAP APIs are included) result in concurrent data exceptions.</div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="3812742">In general, avoid calling locally-hosted SOAP APIs from within a plugin or the rules </a>engine. There are various problems if you call SOAP APIs that modify entities that are currently in use, including but not limited to APIs that might change the message root entity.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>