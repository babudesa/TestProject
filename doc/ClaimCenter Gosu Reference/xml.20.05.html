<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Collection-like Enhancements with XML Nodes</title>
    <link rel="StyleSheet" href="css/xml.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>Gosu Reference Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="xml.20.01.html#1450607">Gosu and XML</a> : Collection-like Enhancements with XML Nodes</span></div>
    <hr align="left" />
    <blockquote>
      <div class="H1_-_Heading_1"><a name="1450607">Collection-like Enhancements with XML Nodes</a></div>
      <div class="B_-_Body"><a name="1453420">Given an XML node, you can easily extract a list of direct child nodes (child elements), or a list of all nodes (all </a>descendent elements) in the tree. In both cases, Gosu returns the nodes as a <span class="cv_-_computer_voice">List</span> of <span class="cv_-_computer_voice">XMLNode</span> objects, which is specified in Gosu Generics notation as <span class="cv_-_computer_voice">List&lt;XMLNode&gt;</span>. The Gosu language provides built-in enhancements (methods added to classes) for these Java-based collection classes. You can use these collection enhancements to find and iterate across multiple items in a list of XML nodes in Gosu. Additionally, the <span class="cv_-_computer_voice">XMLNode</span> class itself provides methods (implemented through enhancements) that mirror several of these helpful utilities directly on the <span class="cv_-_computer_voice">XMLNode</span> element. </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="1453424">For more information, see </a><a href="javascript:WWHClickedPopup('gosu', 'generics.18.1.html#1455314', '');" title="Gosu Generics">“Gosu Generics”</a>. Be aware that in Gosu, the type called <span class="cv_-_computer_voice">List</span> is shorthand for the Java utility class <span class="cv_-_computer_voice">java.util.ArrayList</span>. </div>
      <div class="B_-_Body"><a name="1445785">The following three methods exist on the </a><span class="cv_-_computer_voice">XMLNode</span> element itself and also any lists of nodes extracted from a node.</div>
      <div class="B_-_Body"><a name="1452664">The list method </a><span class="cv_-_computer_voice">findAll(...)</span> accepts an in-line function called a <span class="e_-_emphasis">block</span> expression, which allows you to concisely describe XPath-style searches. You can use either simple queries or complex Gosu calculations within your block expression. You can use this method directly on <span class="cv_-_computer_voice">XMLNode</span> or on collections of <span class="cv_-_computer_voice">XMLNode</span> elements.</div>
      <div class="B_-_Body"><a name="1450676">You can also use </a><span class="cv_-_computer_voice">findFirst</span>, which is similar to <span class="cv_-_computer_voice">findAll</span> but only returns the first match of the supplied criteria. You can use this method directly on <span class="cv_-_computer_voice">XMLNode</span> or on collections of <span class="cv_-_computer_voice">XMLNode</span> elements.</div>
      <div class="B_-_Body"><a name="1453529">To iterate across all descendent nodes (not just direct child nodes), use the </a><span class="cv_-_computer_voice">each</span> method which takes one parameter that is a block that describes the action to perform. </div>
      <div class="B_-_Body"><a name="1453530">If you call </a><span class="cv_-_computer_voice">each</span> method or the <span class="cv_-_computer_voice">findFirst</span> method directly on a node, the methods operate on tree nodes in <span class="e_-_emphasis">depth-</span><span class="e_-_emphasis">first</span> order. Depth-first order in this context means that it recursively processes each node before proceeding to the next sibling. Gosu processes each node and then processes each of its child nodes before the system processes a node’s own siblings. For example, suppose a root node had three child nodes and each of those child nodes had five child nodes which are grandchildren of the root node. The <span class="cv_-_computer_voice">each</span> method processes the root node first. Next, it processes the first child node. Next, it processes the five grandchildren of the first child. Next, it processes the other two child nodes of the root recursively in the same way.</div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="1443589">For a full reference with examples of collection-related APIs, most of which use blocks, </a>see <a href="javascript:WWHClickedPopup('gosu', 'collections.19.1.html#1448766', '');" title="Collections">“Collections”</a>. For more information about blocks, see <a href="javascript:WWHClickedPopup('gosu', 'blocks.17.1.html#1445150', '');" title="Gosu Blocks">“Gosu Blocks”</a>.</div>
      <div class="B_-_Body"><a name="1453279">To search or iterate across all nodes in the tree or iterate across all items, use collection-like enhancement </a>methods directly on the root node. These methods on the root node refer to <span class="s_-_strong">all</span> nodes in the tree. </div>
      <div class="B_-_Body"><a name="1453280">To search or iterate across only direct child nodes, use the collection enhancement methods on the list returned </a>on the <span class="cv_-_computer_voice">Children</span> property of the desired node. In other words, call methods on the value of <span class="cv_-_computer_voice">node.Children</span>. This returns only direct children, and is not recursive.</div>
      <div class="B_-_Body"><a name="1445841">For example:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1445870">Search </a><span class="s_-_strong">all nodes</span> in the tree recursively for an element name, similar to XPath expression <span class="cv_-_computer_voice">"\\MyElement"</span>, given an existing <span class="cv_-_computer_voice">XMLNode</span> assigned to a local variable <span class="cv_-_computer_voice">root</span>:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="1443246">root.findAll(\ n -&gt; n.ElementName == "MyElement")</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1443194">Search </a><span class="s_-_strong">direct child nodes</span> of a the root node for a specific element name:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="1443405">root.Children.findAll(\ n -&gt; n.ElementName == "MyElement")</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1443518">Print the name of </a><span class="s_-_strong">every</span> <span class="s_-_strong">element</span> in the tree:</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="CS_-_Code_Single_Line"><a name="1443519">root.each(\n -&gt; print(node.ElementName))</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1445919">Search </a><span class="s_-_strong">all nodes</span> in the tree for an attribute named <span class="cv_-_computer_voice">"mytitle"</span> and that has exactly&nbsp;one&nbsp;child element:</div>
            </td>
          </tr>
        </table>
      </div>
      <PRE class="CF_-_Code_First_Line"><a name="1450744">var titledAndOneChild = root.findAll( \ n -&gt; n.Attributes["mytitle"] != null AND n.Children.size == 1 )</a></PRE>
      <div class="LP_-_List_Para"><a name="1450745">Then, to test the results with the previous example, print out each title you find:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="1450746">titledAndOneChild.each(\n -&gt; print("found slide with title: " + n.Attributes["title"]))</a></div>
      <div class="B_-_Body"><a name="1450758">For other examples of collection APIs, see </a><a href="javascript:WWHClickedPopup('gosu', 'collections.19.1.html#1448766', '');" title="Collections">“Collections”</a>. However, many of those methods can only be called on actual collections, not a <span class="cv_-_computer_voice">XMLNode</span> element. If you want to add additional functionality to the <span class="cv_-_computer_voice">XMLNode</span> element, you can add enhancements to the <span class="cv_-_computer_voice">IXMLNode</span> interface. Refer to the built-in enhancement <span class="cv_-_computer_voice">gw.util.xml.GWBaseIXMLNodeEnhancement</span> to see similar code that you can use to make new enhancements.</div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="1452780">If you call collection-related methods discussed in this section directly on a node, you </a>are calling methods defined <span class="s_-_strong">on the node itself</span>. These include the <span class="cv_-_computer_voice">findAll</span>, <span class="cv_-_computer_voice">findFirst</span>, and <span class="cv_-_computer_voice">each</span> method for each node object. If you reference the direct child nodes with <span class="ps_-_parameter_in_code_snippets">node</span><span class="cv_-_computer_voice">.Children</span>, Gosu generates a Gosu <span class="cv_-_computer_voice">List</span> of nodes (<span class="cv_-_computer_voice">List&lt;XMLNode&gt;</span>). On these lists, collection methods available are the larger set of <span class="cv_-_computer_voice">List</span> enhancement methods. See <a href="javascript:WWHClickedPopup('gosu', 'collections.19.1.html#1448766', '');" title="Collections">“Collections”</a> for more information about these enhancement methods.</div>
      <div class="HS_-_Head_Sub"><a name="1450759">Attribute Manipulation as Maps</a></div>
      <div class="B_-_Body"><a name="1450800">Gosu stores attributes of an </a><span class="cv_-_computer_voice">XMLNode</span> in maps (instances of <span class="cv_-_computer_voice">java.util.Map</span>) of the type <span class="cv_-_computer_voice">Map&lt;String, String&gt;</span>. That is generics syntax for a map that maps a <span class="cv_-_computer_voice">String</span> value to another <span class="cv_-_computer_voice">String</span> value. Use all of the Java language <span class="cv_-_computer_voice">Map</span> methods as well as the Gosu <span class="cv_-_computer_voice">Map</span> enhancements if manipulating a node’s attributes. </div>
      <div class="B_-_Body"><a name="1450831">A simple example of this is to set attributes:</a></div>
      <div class="CS_-_Code_Single_Line"><a name="1450881">myNode.Attributes["mytitle"] = "My Slideshow Title"</a></div>
      <div class="B_-_Body"><a name="1450884">However, you can use more advanced </a><span class="cv_-_computer_voice">Map</span> enhancements, such as the <span class="cv_-_computer_voice">eachKeyAndValue</span> method that iterates across all key and value pairs in the map:</div>
      <div class="CS_-_Code_Single_Line"><a name="1450840">xml = root.Attributes.eachKeyAndValue( \ s, s2 -&gt; print("I contain key " + s + " and value " + s2 ))</a></div>
      <div class="B_-_Body"><a name="1450853">For the example in the previous section, this prints the following:</a></div>
      <PRE class="CF_-_Code_First_Line"><a name="1450861">I contain the key title and value My NEWER Slideshow Title</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="1450862">I contain the key author and value Andy Applegate</a></PRE>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>