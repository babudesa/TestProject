<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Which Circumstances to Manipulate Database Transactions</title>
    <link rel="StyleSheet" href="css/transactions.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>Gosu Reference Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="transactions.21.1.html#1574067">Bundles and Transactions</a> : Which Circumstances to Manipulate Database Transactions</span></div>
    <hr align="left" />
    <blockquote>
      <div class="H1_-_Heading_1"><a name="1574067">Which Circumstances to Manipulate Database Transactions</a></div>
      <div class="B_-_Body"><a name="1574068">Gosu provides APIs to change how (and at what times) changes to business data entities save to the database. For </a>many programming tasks in Gosu, you do not need to know details of how database transactions work. For example, after rule set execution, related changes to the current objects are automatically committed (made final) in the database. If errors occur that prevent the entire action from safely completing, the entire transaction <span class="e_-_emphasis">rolls</span><span class="e_-_emphasis">&nbsp;</span><span class="e_-_emphasis">back</span>, which means to undo database changes that were tentatively made.</div>
      <div class="B_-_Body"><a name="1555191">Situations that typically do not require special database transaction knowledge include:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1555192">Code that uses find queries and only reads properties.</a></span> If code uses <span class="cv_-_computer_voice">find()</span> queries and only <span class="s_-_strong">gets</span> values from entities retrieved from the database, you probably do not require special database transaction knowledge. See <a href="javascript:WWHClickedPopup('gosu', 'find.html#1005113', '');" title="Find Expressions">“Find Expressions”</a> for related information.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1555221">Standard rule set code.</a></span> Rule set code that operates on a specific entity, such as validation rule sets or pre-setup rule sets. The application sets up a current database transaction and commits it if no errors occur. If you are changing only that entity and its subobjects, Gosu code does not typically require special actions related to database transactions.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1555244">Most plugin code.</a></span> Most plugin code in Gosu and Java that gets a specific entity as an argument to a plugin method has already been set up to use a specific database transaction. If you are changing only that entity and its subobjects, Gosu code does not typically require special actions related to database transactions. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="1572651">There are exceptions in plugin development in Java where database transaction knowledge is neces</a>sary. For example, if you use Java threads, described in see <a href="javascript:WWHClickedPopup('gosu', 'transactions.21.4.html#1561481', '');" title="Running Code in an Entirely New Bundle">“Running Code in an Entirely New Bundle”</a>. Also if you create new entities, see the <span class="cv_-_computer_voice">EntityFactory</span> class discussion in <a href="javascript:WWHClickedPopup('gosu', 'java-gosu.08.10.html#2074121', '');" title="Java Entity Utility APIs">“Java Entity Utility APIs”</a>.</div>
      <div class="B_-_Body"><a name="1554903">Situations that might require special database transaction knowledge include:</a></div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1555417">Code that uses find() and modifies found entities.</a></span> Code to <span class="s_-_strong">set</span> properties in entities retrieved from the database with a <span class="cv_-_computer_voice">find()</span> query must be aware of bundles. Entities are initially read-only if retrieved using a query but can be move to a writable memory location. See <a href="javascript:WWHClickedPopup('gosu', 'transactions.21.3.html#1552732', '');" title="Using Existing Bundles">“Using Existing Bundles”</a> for related database transaction information and <a href="javascript:WWHClickedPopup('gosu', 'find.html#1005113', '');" title="Find Expressions">“Find Expressions”</a> for general <span class="cv_-_computer_voice">find</span> query information.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1559430">Web services written in Gosu that modify data.</a></span> If a web service API implementation modifies data, the API implementation must be aware of database transaction issues. Entities deserialized into Gosu as part of the incoming SOAP API call are automatically added to the current database transaction but are <span class="s_-_strong">not</span> automatically committed. To commit changes to the database, your code must explicitly commit the current collection of entities. If the SOAP API queries the database with <span class="cv_-_computer_voice">find()</span> statements or other APIs and wants to change entity data, you must add found entities to the current transaction. You explicitly must commit changes to the database. See <a href="javascript:WWHClickedPopup('gosu', 'transactions.21.3.html#1552732', '');" title="Using Existing Bundles">“Using Existing Bundles”</a> for related database transaction information.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NI_-_Note_Important">
        <span class="n_-_note">IMPORTANT   </span><a name="1559687">Web service implementations automatically add deserialized SOAP entities to the </a>current database transaction set up for the SOAP API but does <span class="s_-_strong">not</span> automatically commit entities passed to the web service.</div>
      <div class="N_-_Note">
        <span class="n_-_note">Note: </span><a name="1561727">In some cases, you might want to save some entities that were deserialized into the current transac</a>tion but&nbsp;not other entity changes that might occur. To handle this case, create a new database transaction and explicitly add entities to that group. For details, see <a href="javascript:WWHClickedPopup('gosu', 'transactions.21.4.html#1561481', '');" title="Running Code in an Entirely New Bundle">“Running Code in an Entirely New Bundle”</a>.</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1561683">Asynchronous PCF or workflow code.</a></span> Background task code or self-contained code triggered from within PCF files or workflow definition files might perform operations that cannot rely on the current transaction set up by surrounding code. This current transaction is also called the <span class="e_-_emphasis">ambient</span><span class="e_-_emphasis">&nbsp;</span><span class="e_-_emphasis">transaction</span>. See <a href="javascript:WWHClickedPopup('gosu', 'transactions.21.4.html#1561481', '');" title="Running Code in an Entirely New Bundle">“Running Code in an Entirely New Bundle”</a> for details.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="ri_-_run_in_header"><a name="1561690">Java code that spawns threads.</a></span> Bundles must not be shared across threads. See <a href="javascript:WWHClickedPopup('gosu', 'transactions.21.4.html#1561481', '');" title="Running Code in an Entirely New Bundle">“Running Code in an Entirely New Bundle”</a> for details.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="1574506">Committing data to the database can have tremendous effects on application logic and data integrity. You must be </a>careful not to adversely affect other application logic that tracks the following:</div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1574487">what time to commit changes</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline;">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap;">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><a name="1574491">what time to roll back (undo) tentative database changes. </a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="NW_-_Note_Warning">
        <span class="w_-_warning">WARNING  </span><a name="1559879">Be extremely careful only to commit entity changes at appropriate times, or else serious </a>data integrity errors occur. If an entity’s changes commit to the database, changes cannot be rolled back even if errors later in related code. For example, all rule set code must never commit data explicitly. In many cases, such as rule execution, the database commit happens automatically after all related changes succeed.</div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>